<p><strong>Развертка sysmon+winlogbeat\nxlog</strong></p>
<p><strong>Развертка на windows server 2008:</strong></p>
<p>Необходимая версия sysmon - 13.0</p>
<p>Создание директорий:<br />mkdir C:\Monitoring</p>
<p>mkdir C:\Monitoring\Sysmon</p>
<p>mkdir C:\Monitoring\Winlogbeat</p>
<p>В директории перенести файлы из соответствующих папок архива</p>
<p>Установка sysmon:</p>
<p>В mkdir C:\Monitoring\Sysmon закинуть Sysmon.exe</p>
<p><br />Перейти cd C:\Monitoring\Sysmon</p>
<p>Изменить кодировку конфига для 2008 версии windows server:</p>
<p>$content = Get-Content sysmonconfig-export.xml | Out-String</p>
<p>Сохранить без BOM: [System.IO.File]::WriteAllText("$pwd\config-fixed.xml", $content, [System.Text.Encoding]::UTF8)</p>
<p>Установить: .\Sysmon.exe -accepteula -i config-fixed.xml</p>
<p>Проверить установку: Get-Service Sysmon</p>
<p>Winlogbeat не подходит для server2008, ставим nxlog</p>
<p>Создание конфига &ndash; файл config_create</p>

<p>Script для автостарта из директории:</p>
<p>Sysmon.exe -accepteula -i sysmonconfig-export.xml
sc create Winlogbeat binPath="C:\winlogbeat\winlogbeat.exe run -c C:\winlogbeat\winlogbeat.yml" DisplayName="Winlogbeat" start=auto
sc start Winlogbeat
pause</p></p>
