<p><strong>Развертка MikroTik + Suricata </strong>+ <strong>ELK</strong><br /><strong>Архитектура решения:</strong> <br /><img src="data:image/png;base64,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Xd7J95jdju23g64PzQb5aRcQNmtzn6cctdUV364nRru8TT0cGxvzfV5jY2O+fNRBe9DJtavN+323WwddH/ZKLBbTw4cP3YEmvedpM3/1V3/V9hpD1iMV3h+4tYPzu1kb0usORYBp7jKsra1pYWFhRxdg+Xxe+Xxek5OTHf0qYatWq/rqq6/sxS097z676cGDB9rc3NzR6+/+7u/c7b/zne/on/7pn/Tb3/5236eJKBaLunbtmj788EPfDwrhcFilUkmO42hxcdFt0IO+oFvxBpf37t3r6EeLTpkviIGBAcXjcfdXKfsO5n47zPVhL5kv/3w+v+1i5unTp9uex+hEJ3VgeHhYIyMjunPnjvvreLM7aHvhqNaHXC6nfD6/494nz8M8+xWNRjUxMSFna3Rq++6D12622UtHtT4EqVar20aibyWdTstxHNXrdTcwtIMIL3NhefnyZZXLZfeHD6Nb32N76bDVh07a3J2W4060yrtarerRo0daXFzc9h1jet/0WntgO2z1oVMTExOKRCLuHeX5+fltz8bulHl28tatW6pWq3IcR9ls1k7WUrs2pNcdigAzvNVN9te//rUqO+gee+LECY2OjrqF2iryb/brQyd3S7x2ss/98NJLLykaje7o9cILL+jWrVt6+PCh/uM//kPvvvuurly5opdeesnOfs+srKzo8uXL+uCDD1pe3JsGfXFx0Xcxub6+rnq97qYzJ7gpRxNcStIf/vCHwODy8ePHvjuJ3l8KBwYGNDg4uK2+GCZYqFarbjcJ8wXj1e44u+2w1gevaDTqXjg006rsgrQrTy87zerqauCvw53WgUwmo6WlJf3qV7/a9+6xh70+FAoFxZsMotasrI2gsmilXR25c+eOzpw5o3q97nZNq1rdIG272WYvHfb6EKRZuXnvRg0NDQW2xUH1wwSGJogwj+94me6Q+Xze9wOVfQxGs++xg3bY6kOnba46LEdbUD0JEpR3dOuOeLM6oF22B82uXffCYasPu5HeGoH82rVrLX90+Oqrr5peY5jeSIuLi+6PB2Z9p3bahvSiQxFgauvEvnHjhuIddo/18v4qYY/Q5JXJZHxparWaJicn3Yu+nZzIne6zFy0uLurNN9/UX//1X9ur9oT9udZqNV26dEmZTGbb8yjaurNp/+JoP7u2sbHhBveNRkNTU1MaGRlxT1LTde727dvb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" alt="" /><br /><strong>Компоненты</strong>:</p>
<ul>
<li>MikroTik&nbsp;&mdash; зеркалирование трафика в формате TZSP на UDP-порт 37008.</li>
<li>tzsp2pcap&nbsp;&mdash; преобразование TZSP в формат pcap.</li>
<li>tcpreplay&nbsp;&mdash; отправка pcap-трафика в сетевой интерфейс.</li>
<li>Suricata&nbsp;&mdash; анализ трафика в режиме IDS.</li>
<li>Logstash&nbsp;&mdash; сбор и отправка логов в Elasticsearch.</li>
<li>Elasticsearch&nbsp;&mdash; хранение и индексация логов.</li>
<li>Kibana&nbsp;&mdash; визуализация данных.</li>
<li>Elastalert2 &ndash; telegram уведомления</li>
<li>mikrocat &ndash; скрипт для отправки ip из Suricata в address lists Winbox Mikrotik</li>
</ul>
<p><br /><strong>Репозиторий, доступный для загрузки ELK:</strong><br />https://mirrors.tuna.tsinghua.edu.cn/elasticstack/8.x/apt<br /><br /><strong>Тестовый пакет в Kibana</strong></p>
<p>echo "DEBUG_TEST" | nc -u localhost 37008</p>
<p><strong>Пакеты в реальном времени с Mikrotik на порт 37008</strong></p>
<p>sudo tcpdump -i any port 37008 -n &ndash;vv</p>
<p><strong>Запуск pipeline + tzsp0 interface<br /></strong></p>
<p>Скрипт для запуска /etc/restore_pipeline<br />Ошибки рода &ldquo;message too long&rdquo; появляются при получении от mikrotik пакета размером больше, чем указанный на tzsp0 mtu</p>
<p><strong>Проверка всех индексов</strong><br />curl -X GET "http://127.0.0.1:9200/_cat/indices?v"</p>
<p><strong>Проверка пишет ли Logstash индексы Suricata</strong></p>
<p>curl -X GET "http://127.0.0.1:9200/_cat/indices?v" | grep -i suricata</p>
<p><strong>Suricata logs:</strong> /var/log/suricata/eve.json</p>
<p><strong>Logstash log</strong>s: /var/log/logstash/logstash-plain.log<br /><br /><strong>Общий анализ:<br /></strong>Скрипт для запуска /etc/status_check.sh ./status_check.sh</p>
<p><strong>Создание выделенного интерфейса:</strong></p>
<p>sudo ip link add tzsp0 type dummy <br />sudo ip addr add 10.10.10.1/24 dev tzsp0 <br />sudo ip link set tzsp0 up</p>
<p><strong>Suricata</strong></p>
<p><strong>Тестово отключены шумящие правила:</strong> <br /><br />SURICATA STREAM Packet with invalid ack</p>
<p>SURICATA STREAM SHUTDOWN RST invalid ack</p>
<p>SURICATA TCPv4 invalid checksum <br />Multiple SYN packets to HTTP port(CVE-2025-59147) &ndash; Suricata flood</p>
<p>Проверка лога Suricata:</p>
<p>tail -f /var/log/suricata/suricata.log</p>
<p>Лог детектированных угроз:</p>
<p>Лежит здесь:&nbsp;/var/log/suricata/fast.log<br />Посмотреть 30 последних записей: tail -30 /var/log/suricata/fast.log<br />Отработанные события по типу: cat /var/log/suricata/eve.json 2&gt;/dev/null | jq -r '.event_type' | sort | uniq &ndash;c<br />Отображение алертов в реальном времени: sudo tail -f /var/log/suricata/eve.json | jq 'select(.event_type=="alert")'</p>
<p>Правила Suricata:</p>
<p>Обновление правил - sudo suricata-update<br />Отображение всех правил источников - sudo suricata-update list-sources</p>
<p>Список правил, загружаемых Suricata - /var/lib/suricata/rules/suricata.rules</p>
<p>Файл классификации событий по типам и приоритетам - /var/lib/suricata/rules/classification.config<br />Статистика Suricata - sudo tail -f /var/log/suricata/stats.log | grep -E "(capture|decod|drop)"</p>
<p>Скрипт проверки скорости пакетов /etc# ./packets_speed_test<br />Добавление индекса для автоматического обновления правил:<br /><br />Добавить индекс - sudo suricata-update enable-source <em>ИНДЕКС<br /></em>Просмотреть индексы - sudo suricata-update list-sources<br />Какие индексы включены - sudo suricata-update list-sources --enabled<br />Обновление источников - sudo suricata-update update-sources<br />Файлы с включенными правилами на 25.12:<br /><img src="data:image/png;base64,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" alt="" /></p>
<p><strong>elasticsearch</strong></p>
<p>При блокировке индексов по памяти &ndash; чистим место и разблокируем <br /><br />curl -X PUT -u elastic:PASSWORD "http://localhost:9200/_all/_settings" \</p>
<p>-H "Content-Type: application/json" \</p>
<p>-d '{"index.blocks.read_only_allow_delete": null}'</p>
<p><strong>elastalert2</strong></p>
<p>Скрипт - /opt/scripts/send_telegram.py</p>
<p>Конфиг - /etc/elastalert2/config.yaml<br /><br />Просмотр событий в реальном времени - sudo journalctl -u elastalert2 -f --no-pager</p>
<p><strong>scripts</strong></p>
<p>Основные скрипты в /opt/scripts/ :<br />status_check.sh &ndash; общий статус системы<br />send_telegram.py &ndash; скрипт elastalert2 для пересылки уведомлений в telegram<br />restore_pipeline &ndash; скрипт для перезапуска tcpreplay<br />suricata_poor_reputation_block.py &ndash; скрипт автоматического добавления адресов из Poor Reputation IP правил в address list Mikrotik<br />packets_speed_test &ndash; статистика проходящих пакетов<br /><br />Выполнена ротация логов с конфигурационным файлом в /etc/logrotate.d/suricata-syslog</p>
<p>Проверка ротации - systemctl status logrotate.timer</p>
<p><strong>mikrocat</strong></p>
<p>Просмотр логов в реальном времени - sudo journalctl -u mikrocat -f</p>